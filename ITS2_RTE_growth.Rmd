---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: console
---

RTE2016 ITS2 data Symportal and growth data

```{r}
library(tidyverse)

RTE_g<-read.csv("RTE2016 fitness scores by genotype.csv")
RTE_ITS<-read.csv("RTE_ITS2clade.csv")
RTE_meta<-read.csv("RTE2016_frag_masterlist2.csv")

#Add parent ID to ITS

RTE.ITS<-merge(RTE_ITS,RTE_meta, by="FragID2", all.x=T ) 

RTE.ITS.mcap<-subset(RTE.ITS, Species=="Montipora capitata")
RTE.ITS.mcap2<-RTE.ITS.mcap[,c(1,3:5,10:12)]

#merge with growth by frag.ID
RTE_g2<-subset(RTE_g, Species=="Montipora")
#change Inner and Outer to 13 and 4
RTE_g3<-RTE_g2 %>%
  mutate(FragSite = case_when(
    endsWith(TransplantSite, "Inner Bay") ~ "Reef 4",
    endsWith(TransplantSite, "Outer Bay") ~ "Reef 13"
    ))

RTE_g3<-RTE_g3 %>%
  mutate(ParentSite = case_when(
    endsWith(OriginSite, "Inner Bay") ~ "Reef 4",
    endsWith(OriginSite, "Outer Bay") ~ "Reef 13"
    ))

 RTE_g3<-RTE_g3[,c(5:7,10:12)]
 
  
  
#ITS2 parent x origin x transplant
 
 RTE.ITS.mcap3<-RTE.ITS.mcap2[!(RTE.ITS.mcap2$DIV=="C15"),] #remove impossible, figure out what is happening here later
  RTE.ITS.mcap3<-RTE.ITS.mcap2[!(RTE.ITS.mcap2$clade=="B"),]

RTE.ITS.mcap4<-RTE.ITS.mcap3 %>%
  group_by(ParentTagID, ParentSite, FragSite) %>%
  count(clade)

write.csv(RTE.ITS.mcap4, "RTE.ITS.mcap4.csv") #couldn't figure out so did by hand
RTE.ITS.mcap5<-read.csv("RTE.ITS.mcap5.csv")


# merge 
 
RTE.growth.ITS<-merge(RTE_g3,RTE.ITS.mcap5, by=c("ParentTagID", "ParentSite","FragSite"), all.x=T )
RTE.growth.ITS$code<-paste(RTE.growth.ITS$clade)


names(RTE.growth.ITS)[4] <- 'growth'

# Basic box plot
p<-ggplot(RTE.growth.ITS, aes(x=clade, y=growth)) + 
  geom_boxplot()

p+facet_wrap(~ParentSite+FragSite)


p<-ggplot(RTE.growth.ITS, aes(x=clade, y=growth)) + 
  geom_boxplot()

```


